<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>ComboBox Databinding Sample</title></head><body><h1>ComboBox Databinding Sample</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"><font color="DarkGray"></font><p /></div><div class="introduction"><p>To get samples and instructions for installing them, see the following:</p><ul><li><p>Click <span class="ui">Samples</span> on the Visual Studio <span class="ui">Help</span> menu.</p><p>For more information, see <mshelp:link keywords="e121a9c2-b35b-4b3f-8cba-30edd84c835f" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">Locating Sample Files</mshelp:link>.</p></li><li><p>The most recent versions and the complete list of samples are available on the Visual Studio 2008 Samples Web site. </p></li><li><p>You can also locate samples on your computer's hard disk. By default, samples and a Readme file are copied to a folder under \Program Files\Visual Studio 9\Samples\. For Visual Studio Express Editions, all samples are located on the Internet.</p><div class="alert"><table width="100%"    IS" without warranties.</p></td></tr></table></div></li></ul></div><h3 class="procedureSubHeading">To run this sample</h3><div class="subSection"><ul><li><p>Press F5.</p></li></ul></div><h1 class="heading"><span   style="cursor:default;  tabindex="0">Requirements</span></h1><div id="requirementsTitleSection" class="section" name="collapseableSection" style=""><p>This sample requires the Northwind sample database. For more information, see <mshelp:link keywords="8b3cee2b-1bd8-4917-91ca-e90a6c557794" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">How to: Install and Troubleshoot Database Components for Samples</mshelp:link>.</p></div><h1 class="heading"><span   style="cursor:default;"   tabindex="0">Demonstrates</span></h1><div id="demonstratesSection" class="section" name="collapseableSection" style=""><p>The code demonstrates how to bind six different types of data sources to a <mshelp:link keywords="T:System.Windows.Forms.ComboBox" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">ComboBox</mshelp:link> control. Data is bound from:   </p><ul><li><p>an array</p></li><li><p>an <mshelp:link keywords="T:System.Collections.ArrayList" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">ArrayList</mshelp:link> of strings</p></li><li><p>an <mshelp:link keywords="T:System.Collections.ArrayList" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">ArrayList</mshelp:link> of class objects</p></li><li><p>a <mshelp:link keywords="T:System.Data.DataTable" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">DataTable</mshelp:link></p></li><li><p>a <mshelp:link keywords="T:System.Data.DataView" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">DataView</mshelp:link></p></li><li><p>a <mshelp:link keywords="T:System.Windows.Forms.BindingSource" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">BindingSource</mshelp:link> object  </p></li></ul><p>When the main form loads, the <span class="code">Products</span> table from the Northwind database is retrieved into a <mshelp:link keywords="T:System.Data.DataSet" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">DataSet</mshelp:link> using a simple SQL Select statement. A <mshelp:link keywords="T:System.Data.DataView" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">DataView</mshelp:link> that provides a sorted view of the <span class="code">ProductName</span> column is also created at this time. The <span class="code">Products</span> table is loaded into another <mshelp:link keywords="T:System.Data.DataSet" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">DataSet</mshelp:link> using a TableAdapter and <mshelp:link keywords="T:System.Windows.Forms.BindingSource" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">BindingSource</mshelp:link>.</p><p>The user can then populate the combo box control by binding to another array of colors, an array list of shapes, an advanced array list containing sales divisions defined with a structure, the products table residing in either dataset, or the sorted data view. If the user binds to the dataset, data view or the advanced array list of sales divisions, when an entry is selected from the combo box, an associated value for that entry is also displayed. If the user binds to the data connector, the combo box and datagridview are in sync. Changing the value of the combo box moves the datagridview to the same record. Scrolling through the dataset in the grid or using the navigation toolbar updates the combo box.</p><p>The main form contains the combo box controls, button controls to load data, and two label controls and a grid to display the data source and the selected value. The <mshelp:link keywords="T:System.Collections.ArrayList" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">ArrayList</mshelp:link>, <mshelp:link keywords="T:System.Data.DataSet" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">DataSet</mshelp:link>, and <mshelp:link keywords="T:System.Data.DataView" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">DataView</mshelp:link> allow you to associate a value with each item displayed in the combo box control. For example, if the user selects the product entry <span class="code">Chai</span> from the products table bound to the combo box, Chai is displayed as the selected entry, but its associated <span class="code">ProductId</span> is also available through the <mshelp:link keywords="P:System.Windows.Forms.ListControl.SelectedValue" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">SelectedValue</mshelp:link> property. The <mshelp:link keywords="P:System.Windows.Forms.ListControl.ValueMember" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">ValueMember</mshelp:link> property allows you to select the item that contains the associated value. The <mshelp:link keywords="P:System.Windows.Forms.ListControl.DisplayMember" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">DisplayMember</mshelp:link> property allows you to select the item that is displayed in the combo box control.</p><h1 class="heading"><span   style="cursor:default;  tabindex="0">Creating this Sample</span></h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Most of this form was created by dragging components onto the form, then using smart tags and settings in the <span class="ui">Properties</span> window. The following is a quick summary of how you could create the <mshelp:link keywords="T:System.Windows.Forms.DataGridView" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">DataGridView</mshelp:link> portion of the form from scratch:</p><ol><li><p>Create a new Windows Application project.</p></li><li><p>With <span class="code">Form1</span> open, select the <span class="ui">Data Source</span> window. It can also be activated by means of the <span class="ui">Data</span> menu.</p></li><li><p>In the <span class="ui">Data Sources</span> window, click <span class="ui">Add New Data Source</span>. </p></li><li><p>In the <span class="ui">Data Source Configuration Wizard</span>, choose Database as the data source type.</p></li><li><p>For the data connection, choose a server that has Northwind on it.  </p></li><li><p>The following step allows you to save the connection string in a strongly typed application settings file.</p><ol><li><p>In the Choose Your Database Objects, select the <span class="code">Products</span> table.</p></li><li><p>Click <span class="ui">Finish</span> to create your typed dataset for the Northwind database. You can see the results in the <span class="ui">Data Sources</span> window.</p></li></ol></li><li><p>From the <span class="ui">Data Sources</span> window, drag the <span class="code">Products</span> table to <span class="code">Form1</span>.</p></li><li><p>As a result, you will see a data-bound <mshelp:link keywords="T:System.Windows.Forms.DataGridView" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">DataGridView</mshelp:link> and <mshelp:link keywords="T:System.Windows.Forms.BindingNavigator" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">BindingNavigator</mshelp:link> controls added to the form designer surface. You will also see the <span class="code">NorthwindDataSet</span>, <span class="code">ProductsTableAdapter</span>, and <span class="code">ProductsBindingSource</span> added to the component tray.</p></li></ol></div><h1 class="heading"><span   style="cursor:default;"   tabindex="0">Loading Data Within the Form</span></h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>In this example, you load the form with data without any parameters provided by the user. Using the <span class="ui">DataSet Designer</span> you can to leverage reusable <mshelp:link keywords="T:System.Data.Common.DataAdapter" tabindex="0" xmlns:mshelp="http://msdn.microsoft.com/mshelp">DataAdapter</mshelp:link>s to fill <span class="code">dsProducts2</span>.  </p><p>When you drag the <span class="ui">Employees</span> table from the <span class="ui">Data Sources</span> window, Visual Studio automatically places code to call the default query on the TableAdapter in the <span class="code">Form.Load</span> event. In this sample this code was moved to the <span class="code">btnDC</span> Click method:</p><div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><td colspan="2"><pre>' Fill the Lookup Tables
Me.ProductsTableAdapter.Fill(Me.NorthwindDataSet.Products)
</pre></td></tr></table></span></div></div></div></div><div id="footer"><div class="footerLine"></div><!--<include item="copyrightStatement"/>--><A NAME="feedback"></A><span id="fb" class="feedbackcss" /> 
             
                
               
                
                
               
               
               
              
                
               
              
               
               
               
         </div></div></body></html>
